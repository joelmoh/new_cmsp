<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMSP - Auto Lesson</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="global.css">
    <script src="js/api.js" async="" defer=""></script> <!--SEU LINK PARA ALGUMA API-->
    <script src="js/script.js" defer=""></script> <!--Código Antigo-->
    <script src="add.js"></script> <!-- Código Alterado -->
</head>

<body>
    <h1 class="large-text text-center">CMSP - Auto Lesson</h1>
    <p class="text-center">OBS: Esse script não realiza provas paulistas e nem redações</p>
    <div class="centered">
        <div class="container">
            <main class="form-signin w-100 m-auto">
                <div class="row g-3 align-items-center">
                    <div class="col-8 ra-input">
                        <label for="">Registro do Aluno</label>
                        <input type="text" id="ra" class="form-control" placeholder="000_________-_" data-slots="_">
                    </div>
                    <div class="col-auto">
                        <label for="uf">UF</label>
                        <select class="form-select" aria-label="Large select example">
                            <option value="ac">AC</option>
                            <option value="al">AL</option>
                            <option value="ap">AP</option>
                            <option value="am">AM</option>
                            <option value="ba">BA</option>
                            <option value="ce">CE</option>
                            <option value="df">DF</option>
                            <option value="es">ES</option>
                            <option value="go">GO</option>
                            <option value="ma">MA</option>
                            <option value="mt">MT</option>
                            <option value="ms">MS</option>
                            <option value="mg">MG</option>
                            <option value="pa">PA</option>
                            <option value="pb">PB</option>
                            <option value="pr">PR</option>
                            <option value="pe">PE</option>
                            <option value="pi">PI</option>
                            <option value="rj">RJ</option>
                            <option value="rn">RN</option>
                            <option value="rs">RS</option>
                            <option value="ro">RO</option>
                            <option value="rr">RR</option>
                            <option value="sc">SC</option>
                            <option value="sp" selected>SP</option>
                            <option value="se">SE</option>
                            <option value="to">TO</option>
                        </select>
                    </div>
                    <div class="row g-3 align-items-center">
                        <div>
                            <label for="">Senha</label>

                            <input type="password" id="password" class="form-control"
                                aria-describedby="passwordHelpInline"> <br>
                        </div>
                        <div class="h-captcha" data-sitekey="03b2d394-013a-46fc-a3f2-1b06625e021a" id="hcaptcha"><iframe
                                src="https://newassets.hcaptcha.com/captcha/v1/6416769/static/hcaptcha.html#frame=checkbox&amp;id=0iawtxbqytfa&amp;host=cmsp-cheeto-v2.vercel.app&amp;sentry=true&amp;reportapi=https%3A%2F%2Faccounts.hcaptcha.com&amp;recaptchacompat=true&amp;custom=false&amp;hl=pt-BR&amp;tplinks=on&amp;pstissuer=https%3A%2F%2Fpst-issuer.hcaptcha.com&amp;sitekey=03b2d394-013a-46fc-a3f2-1b06625e021a&amp;theme=light&amp;origin=https%3A%2F%2Fcmsp-cheeto-v2.vercel.app"
                                tabindex="0" frameborder="0" scrolling="no"
                                allow="private-state-token-issuance 'src'; private-state-token-redemption 'src'"
                                title="Widget contendo caixa de seleção para desafio de segurança hCaptcha"
                                data-hcaptcha-widget-id="0iawtxbqytfa" data-hcaptcha-response=""
                                style="pointer-events: auto; background-color: rgba(255, 255, 255, 0); width: 303px; height: 78px; overflow: hidden;"></iframe><textarea
                                id="g-recaptcha-response-0iawtxbqytfa" name="g-recaptcha-response"
                                style="display: none;"></textarea><textarea id="h-captcha-response-0iawtxbqytfa"
                                name="h-captcha-response" style="display: none;"></textarea></div>
                    </div>
                    
            </main>



            <div class="button-group">
                <input type="button" class="btn btn-primary mb-1" value="Lições Normais"
                    onclick="verifyCaptcha('fazerlicaonormal')">
                <input type="button" class="btn btn-danger mb-1" value="Lições Atrasadas"
                    onclick="verifyCaptcha('fazerlicaoatrasada')">
            </div>
        </div>
        <div class="container">
            <h5>Dúvidas?</h5>
            Discord: <a href="https://discord.com/invite/platformdestroyer">Clique aqui</a> <br>
            E-mail: <a href="mailto:enfieh@proton.me">Clique aqui</a>

            
        </div>

        



        <script>
            async function verifyCaptcha(funcName) {
                const hcaptchaResponse = hcaptcha.getResponse();

                if (hcaptchaResponse.length === 0) {
                    alert('Faz o captcha doidokkk');
                } else {
                    const name = document.getElementById('name').value;
                    const password = document.getElementById('password').value;

                    try {
                        const response = await fetch('https://cmsp-cheeto-v2.vercel.app/verify-captcha', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                'h-captcha-response': hcaptchaResponse,
                            }),
                        });

                        if (response.ok) {
                            const key = await response.text();

                            if (funcName === 'fazerlicaonormal') {
                                fazerlicaonormal(name, password, key);
                            } else if (funcName === 'fazerlicaoatrasada') {
                                fazerlicaoatrasada(name, password, key);
                            }
                        } else {
                            alert('Verificação do captcha falhou');
                        }
                    } catch (error) {
                        console.error('Erro ao verificar o captcha:', error);
                        alert('Erro ao verificar o captcha');
                        console.log(hcaptchaResponse)
                    }

                    hcaptcha.reset();
                }
            }

        </script>


</body>

</html>